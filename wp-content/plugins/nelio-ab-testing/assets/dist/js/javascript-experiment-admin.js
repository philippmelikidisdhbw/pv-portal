(()=>{var e,t={3840:(e,t,a)=>{"use strict";window.wp.coreData,window.wp.domReady;const r=window.nab.data,n=window.wp.element,i=window.nab.experimentLibrary,o=window.wp.data;function s(e,t){return(0,o.useSelect)(e,t)}const c=window.nab.editor,l=window.wp.compose,v=window.wp.url;var d=a(6942),u=a.n(d);const p=window.lodash,b=window.nab.utils,m=window.wp.components,f=window.wp.i18n;var w,g=function(e){var t=e.isSaving,a=e.save,r=_();return n.createElement("div",{className:"nab-javascript-editor-sidebar__actions"},n.createElement("div",{className:"nab-javascript-editor-sidebar__back-to-experiment"},n.createElement("a",{className:"nab-javascript-editor-sidebar__back-to-experiment-link",href:r,title:(0,f._x)("Back to test…","command","nelio-ab-testing")},n.createElement(m.Dashicon,{icon:"arrow-left-alt2"}))),n.createElement("div",{className:"nab-javascript-editor-sidebar__save-info"},t&&n.createElement("span",{className:"nab-javascript-editor-sidebar__saving-label"},n.createElement(m.Dashicon,{icon:"cloud"}),(0,f._x)("Saving…","text","nelio-ab-testing")),n.createElement(m.Button,{variant:"primary",disabled:t,onClick:a},(0,f._x)("Save and Preview","command","nelio-ab-testing"))))},_=function(){return s((function(e){var t;return null===(t=e(c.store).getExperimentAttribute("links"))||void 0===t?void 0:t.edit}))},E=function(e){var t=e.value,a=e.onChange;return n.createElement("div",{className:"nab-javascript-editor-sidebar__editor"},n.createElement("textarea",{style:t?void 0:{whiteSpace:"pre-wrap"},placeholder:j,value:t,onChange:function(e){return a(e.target.value)},autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"}),!!(0,p.trim)(t)&&!/\bdone\(\)/.test((0,p.trim)(t))&&n.createElement("div",{className:"nab-javascript-editor-sidebar__editor-error"},(0,f._x)("“done()” not found","user","nelio-ab-testing")))},j=[(0,f._x)("Write your JavaScript snippet here. Here are some useful tips:","user","nelio-ab-testing"),"\n","\n- ",(0,f.sprintf)(/* translators: variable name */ /* translators: variable name */
(0,f._x)("Declare global variable “%s”","text","nelio-ab-testing"),"abc"),"\n  window.abc = abc;","\n","\n- ",(0,f._x)("Run callback when dom is ready","text","nelio-ab-testing"),"\n  utils.domReady( callback );","\n","\n- ",(0,f._x)("Show variant:","text","nelio-ab-testing"),"\n  utils.showContent();","\n","\n- ",(0,f._x)("Show variant and track events","text","nelio-ab-testing"),"\n  done();"].join(""),h=function(){var e=(0,r.usePageAttribute)("javascript-preview/areControlsVisible",!0),t=e[0],a=e[1],i=(0,r.usePageAttribute)("javascript-preview/activeResolution","desktop"),o=i[0],s=i[1];return n.createElement("div",{className:"nab-javascript-editor-sidebar__footer-actions"},n.createElement("div",{className:u()({"nab-javascript-editor-sidebar__visibility-toggle":!0,"nab-javascript-editor-sidebar__visibility-toggle--hide":!!t,"nab-javascript-editor-sidebar__visibility-toggle--show":!t})},n.createElement(m.Button,{variant:"link",onClick:function(){return a(!t)}},t?n.createElement(n.Fragment,null,n.createElement(m.Dashicon,{icon:"admin-collapse"}),n.createElement("span",{className:"nab-javascript-editor-sidebar__visibility-toggle-label"},(0,f._x)("Hide Controls","command","nelio-ab-testing"))):n.createElement(m.Dashicon,{icon:"admin-collapse"}))),n.createElement("div",{className:"nab-javascript-editor-sidebar__resolutions"},n.createElement("div",{className:u()({"nab-javascript-editor-sidebar__resolution":!0,"nab-javascript-editor-sidebar__resolution--is-active":"desktop"===o})},n.createElement(m.Button,{variant:"link",onClick:function(){return s("desktop")}},n.createElement(m.Dashicon,{icon:"desktop"}),n.createElement("span",{className:"screen-reader-text"},(0,f._x)("Enter desktop preview mode","command","nelio-ab-testing")))),n.createElement("div",{className:u()({"nab-javascript-editor-sidebar__resolution":!0,"nab-javascript-editor-sidebar__resolution--is-active":"tablet"===o})},n.createElement(m.Button,{variant:"link",onClick:function(){return s("tablet")}},n.createElement(m.Dashicon,{icon:"tablet"}),n.createElement("span",{className:"screen-reader-text"},(0,f._x)("Enter tablet preview mode","command","nelio-ab-testing")))),n.createElement("div",{className:u()({"nab-javascript-editor-sidebar__resolution":!0,"nab-javascript-editor-sidebar__resolution--is-active":"mobile"===o})},n.createElement(m.Button,{variant:"link",onClick:function(){return s("mobile")}},n.createElement(m.Dashicon,{icon:"smartphone"}),n.createElement("span",{className:"screen-reader-text"},(0,f._x)("Enter mobile preview mode","command","nelio-ab-testing"))))))},x=function(){return x=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},x.apply(this,arguments)},y=function(e){var t=e.className,a=e.alternativeId,r=e.isSaving,i=e.save,o=k(a),s=o[0],c=o[1];return n.createElement("div",{className:u()(["nab-javascript-editor-sidebar",t])},n.createElement(g,{isSaving:r,save:i}),n.createElement(E,{value:s,onChange:c}),n.createElement(h,null))},k=function(e){var t,a=s((function(t){return t(c.store).getAlternative(e)})),r=(null===(t=null==a?void 0:a.attributes)||void 0===t?void 0:t.code)||"",n=(0,o.useDispatch)(c.store).setAlternative;return[r,function(e){a&&n(a.id,x(x({},a),{attributes:(0,b.omitUndefineds)(x(x({},a.attributes),{code:e}))}))}]},N=function(e){var t,a=e.className,i=e.iframeId,o=e.isSaving,s=e.previewUrl,c=(0,r.usePageAttribute)("javascript-preview/activeResolution","desktop")[0];return n.createElement("div",{className:u()([a,"nab-javascript-preview"])},n.createElement("iframe",{id:i,className:u()((t={"nab-javascript-preview__iframe":!0},t["nab-javascript-preview__iframe--".concat(c)]=!0,t["nab-javascript-preview__iframe--is-saving"]=o,t)),title:(0,f._x)("JavaScript Preview","text","nelio-ab-testing"),src:s}))},O=function(e){var t=e.alternativeId,a=(0,l.useInstanceId)(O),i="nab-javascript-previewer__iframe-".concat(a),o=(0,r.usePageAttribute)("javascript-preview/areControlsVisible",!0)[0],s=S(t),c=C(),v=A(i),d=v[0],p=v[1];return n.createElement("div",{className:"nab-javascript-editor"},n.createElement(y,{className:u()({"nab-javascript-editor__sidebar":!0,"nab-javascript-editor__sidebar--is-collapsed":!o}),alternativeId:t,isSaving:d,save:p}),n.createElement(N,{key:"nab-javascript-editor__preview",className:u()({"nab-javascript-editor__preview":!0,"nab-javascript-editor__preview--is-fullscreen":!o}),iframeId:i,isSaving:d,previewUrl:c,value:s}))},S=function(e){return s((function(t){var a,r;return(null===(r=null===(a=t(c.store).getAlternative(e))||void 0===a?void 0:a.attributes)||void 0===r?void 0:r.code)||""}))},C=function(){return s((function(e){var t=(0,e(c.store).getAlternative)("control");if(t){var a=e(c.store),r=a.getAlternatives,n=a.getExperimentId,i=(0,v.getQueryArgs)(document.location.href).alternative||"",o=r(),s=n(),l=(0,p.indexOf)((0,p.map)(o,"id"),i),d=t.links&&t.links.preview||"/",u=(0,v.removeQueryArgs)(d,"nab-preview","experiment","alternative","timestamp","nabnonce");return(0,v.addQueryArgs)(u,{"nab-javascript-previewer":"".concat(s,":").concat(l)})}}))},A=function(e){var t=s((function(e){return!!e(r.store).getPageAttribute("javascript-preview/isLoading")})),a=(0,o.useDispatch)(r.store).setPageAttribute,n=(0,o.useDispatch)(c.store).saveExperiment;return[t,function(){a("javascript-preview/isLoading",!0),n().then((function(){var t,r=document.getElementById(e);null===(t=null==r?void 0:r.contentWindow)||void 0===t||t.location.reload(),setTimeout((function(){return a("javascript-preview/isLoading",!1)}),5e3)}))}]},I=function(e){var t=e.experimentId,a=e.alternativeId,i=s((function(e){return e(r.store).getExperiment(t)}));return i?n.createElement(n.StrictMode,null,n.createElement(c.EditorProvider,{experiment:i},n.createElement(O,{alternativeId:a}))):null},P=function(){return P=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},P.apply(this,arguments)};window.nab=P(P({},(w=window)&&"object"==typeof w&&"nab"in w?window.nab:{}),{initJavaScriptEditorPage:function(e,t){(0,i.registerCoreExperiments)();var a=document.getElementById(e);if(a){var r,o,s=t.experimentId,c=t.alternativeId;r=n.createElement(I,{experimentId:s,alternativeId:c}),(o=a)&&(n.createRoot?(0,n.createRoot)(o).render(r):(0,n.render)(r,o))}}})},6942:(e,t)=>{var a;!function(){"use strict";var r={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=o(e,i(a)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var a in e)r.call(e,a)&&e[a]&&(t=o(t,a));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(a=function(){return n}.apply(t,[]))||(e.exports=a)}()}},a={};function r(e){var n=a[e];if(void 0!==n)return n.exports;var i=a[e]={exports:{}};return t[e](i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,a,n,i)=>{if(!a){var o=1/0;for(v=0;v<e.length;v++){a=e[v][0],n=e[v][1],i=e[v][2];for(var s=!0,c=0;c<a.length;c++)(!1&i||o>=i)&&Object.keys(r.O).every((e=>r.O[e](a[c])))?a.splice(c--,1):(s=!1,i<o&&(o=i));if(s){e.splice(v--,1);var l=n();void 0!==l&&(t=l)}}return t}i=i||0;for(var v=e.length;v>0&&e[v-1][2]>i;v--)e[v]=e[v-1];e[v]=[a,n,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={2676:0,1091:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var n,i,o=a[0],s=a[1],c=a[2],l=0;if(o.some((t=>0!==e[t]))){for(n in s)r.o(s,n)&&(r.m[n]=s[n]);if(c)var v=c(r)}for(t&&t(a);l<o.length;l++)i=o[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(v)},a=self.webpackChunknab=self.webpackChunknab||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var n=r.O(void 0,[1091],(()=>r(3840)));n=r.O(n);var i=nab="undefined"==typeof nab?{}:nab;for(var o in n)i[o]=n[o];n.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();