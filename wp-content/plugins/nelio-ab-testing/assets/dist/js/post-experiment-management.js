(()=>{var e,t={254:(e,t,n)=>{"use strict";const r=window.nab.data,a=window.wp.element,o=window.nab.experimentLibrary,i=window.wp.apiFetch;var l=n.n(i);const s=window.wp.date,c=window.wp.url;var u=function(){return u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},u.apply(this,arguments)};var d=function(e){var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")};const p=window.wp.components,m=window.wp.data;function v(e,t){return(0,m.useSelect)(e,t)}const f=window.wp.i18n,b=window.lodash,g=window.nab.components,E=window.nab.experiments,w=window.nab.utils;var x=function(){return x=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},x.apply(this,arguments)},_=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},I=function(e){var t=e.experimentId,n=e.postBeingEdited,r=e.type,o=P(t);return o?a.createElement(a.Fragment,null,a.createElement(y,{icon:o,experimentId:t}),a.createElement(h,{experimentId:t,postBeingEdited:n}),a.createElement(C,{experimentId:t,postBeingEdited:n,type:r})):null},y=function(e){var t=e.icon,n=e.experimentId,r=O(n),o=B(n);return a.createElement(p.PanelRow,{className:"nab-test-panel"},a.createElement("span",{className:"nab-test-panel__icon"},a.createElement(t,null)),a.createElement("a",{className:"nab-test-panel__name",href:o},r))},h=function(e){var t=e.experimentId,n=e.postBeingEdited,r=N(t);return r?a.createElement(p.PanelRow,{className:"nab-variants-panel"},a.createElement("h2",{className:"nab-variants-panel__title"},(0,f._x)("Variants","text","nelio-ab-testing")),r.map((function(e){var t=e.name,r=e.link,o=e.postId,i=e.index;return a.createElement("div",{className:"nab-alternative",key:o},a.createElement("span",{className:"nab-alternative__letter"},(0,w.getLetter)(i)),a.createElement("span",{className:"nab-alternative__name"},n!==o?a.createElement("a",{href:r},S(t,i)):a.createElement("strong",null,S(t,i))))}))):null},C=function(e){var t,n,r=e.experimentId,o=e.postBeingEdited,i=e.type,l=k(o),s=l[0],c=l[1],u=j(r,o),d=(0,a.useState)(A),m=d[0],v=d[1],b=function(e){return v(x(x({},m),e))},E=m.isImportEnabled,w=m.isConfirmationDialogVisible,_=m.postIdToImportFrom,I=m.variantToImportFrom,y=null!==(n=null===(t=u[0])||void 0===t?void 0:t.value)&&void 0!==n?n:0;if((0,a.useEffect)((function(){I>=0||y<=0||b({postIdToImportFrom:y,variantToImportFrom:y})}),[I,y]),I<0)return null;var h=function(){return b({isImportEnabled:!E})},C=function(){return b({isConfirmationDialogVisible:!w})};return E?a.createElement(p.PanelRow,{className:"nab-content-panel"},a.createElement("h2",{className:"nab-content-panel__title"},(0,f._x)("Content","text","nelio-ab-testing")),a.createElement(p.SelectControl,{label:(0,f._x)("Import content from:","text","nelio-ab-testing"),options:u.map((function(e){return x(x({},e),{value:"".concat(e.value)})})),value:"".concat(I),onChange:function(e){var t;t=Number.parseInt(e)||0,b({variantToImportFrom:t,postIdToImportFrom:t})}}),0===I&&a.createElement(g.PostSearcher,{value:_,className:"nab-content-panel__searcher",type:i,onChange:function(e){return void 0===e&&(e=0),b({variantToImportFrom:0,postIdToImportFrom:e})},menuPlacement:"auto",menuShouldBlockScroll:!0}),a.createElement("div",{className:"nab-content-panel__actions"},a.createElement(p.Button,{variant:"link",onClick:h},(0,f._x)("Cancel","command","nelio-ab-testing")),a.createElement(p.Button,{variant:"secondary",disabled:!_,onClick:C},(0,f._x)("Import","command","nelio-ab-testing")),a.createElement(g.ConfirmationDialog,{title:(0,f._x)("Import Content?","text","nelio-ab-testing"),text:(0,f._x)("This will overwrite the current content.","text","nelio-ab-testing"),confirmLabel:s?(0,f._x)("Importing…","text","nelio-ab-testing"):(0,f._x)("Import","command","nelio-ab-testing"),isConfirmEnabled:!s,isCancelEnabled:!s,isOpen:w,onCancel:C,onConfirm:function(){return c(_)}}))):a.createElement(p.PanelRow,{className:"nab-content-panel"},a.createElement("h2",{className:"nab-content-panel__title"},(0,f._x)("Content","text","nelio-ab-testing")),a.createElement("span",{className:"nab-content-panel__label"},a.createElement(p.Dashicon,{icon:"admin-page"}),a.createElement(p.Button,{variant:"link",onClick:h},(0,f._x)("Import Content","command","nelio-ab-testing"))))},O=function(e){return v((function(t){var n;return(null===(n=t(r.store).getExperiment(e))||void 0===n?void 0:n.name)||(0,f._x)("Unnamed Test","text","nelio-ab-testing")}))},B=function(e){return v((function(t){var n;return(null===(n=t(r.store).getExperiment(e))||void 0===n?void 0:n.links.edit)||""}))},N=function(e){return v((function(t){var n;return(0,b.map)(null===(n=t(r.store).getExperiment(e))||void 0===n?void 0:n.alternatives,(function(e,t){return{index:t,postId:T(e)?e.attributes.postId:0,name:F(e)?e.attributes.name:"",link:e.links.edit}}))}))},P=function(e){return v((function(t){var n,o,i,l,s=t(r.store).getExperiment,c=t(E.store).getExperimentTypes,u=null!==(o=null===(n=s(e))||void 0===n?void 0:n.type)&&void 0!==o?o:"";return null!==(l=null===(i=c()[u])||void 0===i?void 0:i.icon)&&void 0!==l?l:function(){return a.createElement(a.Fragment,null)}}))},k=function(e){var t=(0,a.useState)(0),n=t[0],r=t[1];return(0,a.useEffect)((function(){var t,r,a,o;n&&(t={path:"/nab/v1/post/".concat(n,"/overwrites/").concat(e),method:"PUT"},r=t.url,a=t.path,o=(0,s.format)("YmjHi").substring(0,11)+"0",l()(u(u(u({},t),r&&{url:d(t)?(0,c.addQueryArgs)(r,{nabts:o}):r}),a&&{path:(0,c.addQueryArgs)(a,{nabts:o})}))).finally((function(){window.location.reload()}))}),[n]),[!!n,r]},j=function(e,t){var n=N(e).map((function(e,n){return t===e.postId?void 0:{label:(0,f.sprintf)(/* translators: variant letter */ /* translators: variant letter */
(0,f._x)("Variant %s","text","nelio-ab-testing"),(0,w.getLetter)(n)),value:e.postId}})).filter(w.isDefined);return _(_([],n,!0),[{label:(0,f._x)("Other…","text","nelio-ab-testing"),value:0}],!1)},T=function(e){return!!e.attributes.postId},F=function(e){return!!e.attributes.name},S=function(e,t){return e||(0===t?(0,f._x)("Control Version","text","nelio-ab-testing"):(0,f.sprintf)(/* translators: a letter, such as A, B, or C */ /* translators: a letter, such as A, B, or C */
(0,f._x)("Variant %s","text","nelio-ab-testing"),(0,w.getLetter)(t)))},A={isConfirmationDialogVisible:!1,isImportEnabled:!1,postIdToImportFrom:0,variantToImportFrom:-1};const D=window.wp.plugins;var V,R,L,M=null===(R=null===(V=window.wp)||void 0===V?void 0:V.editPost)||void 0===R?void 0:R.PluginDocumentSettingPanel,Q=M?function(e){var t=e.experimentId,n=e.postBeingEdited,r=e.type;return a.createElement(M,{className:"nab-alternative-editing-sidebar",title:(0,f._x)("Nelio A/B Testing","text","nelio-ab-testing"),icon:"none"},a.createElement(I,{experimentId:t,postBeingEdited:n,type:r}))}:function(){return null},U=function(){return U=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},U.apply(this,arguments)};window.nab=U(U({},(L=window)&&"object"==typeof L&&"nab"in L?window.nab:{}),{initEditPostAlternativeMetabox:function(e){(0,o.registerCoreExperiments)();var t,n,r=e.experimentId,i=e.postBeingEdited,l=e.type,s=document.getElementById("nelioab_edit_post_alternative_box"),c=null==s?void 0:s.getElementsByClassName("inside")[0];c&&(t=a.createElement(I,{experimentId:r,postBeingEdited:i,type:l}),(n=c)&&(a.createRoot?(0,a.createRoot)(n).render(t):(0,a.render)(t,n)))},initEditPostAlternativeBlockEditorSidebar:function(e){(0,o.registerCoreExperiments)();var t=e.experimentId,n=e.postBeingEdited,r=e.type;(0,D.registerPlugin)("nelio-ab-testing",{icon:function(){return a.createElement(a.Fragment,null)},render:function(){return a.createElement(Q,{experimentId:t,postBeingEdited:n,type:r})}})}})}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,n,a,o)=>{if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],a=e[u][1],o=e[u][2];for(var l=!0,s=0;s<n.length;s++)(!1&o||i>=o)&&Object.keys(r.O).every((e=>r.O[e](n[s])))?n.splice(s--,1):(l=!1,o<i&&(i=o));if(l){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,a,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={9197:0,904:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,o,i=n[0],l=n[1],s=n[2],c=0;if(i.some((t=>0!==e[t]))){for(a in l)r.o(l,a)&&(r.m[a]=l[a]);if(s)var u=s(r)}for(t&&t(n);c<i.length;c++)o=i[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(u)},n=self.webpackChunknab=self.webpackChunknab||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[904],(()=>r(254)));a=r.O(a);var o=nab="undefined"==typeof nab?{}:nab;for(var i in a)o[i]=a[i];a.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();